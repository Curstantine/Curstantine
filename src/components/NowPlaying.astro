---
import { GET, type NowPlayingResponse } from "~/pages/api/now-playing";

export const prerender = false;

const resp = await GET(Astro);
const data: NowPlayingResponse = await resp.json();
---

<div class="flex flex-col pt-6">
	<div class="inline-flex items-center text-text-2 mb-1">
		<div class="i-gravity-music-note w-4 h-4 mr-2"></div>
		<span class="text-sm select-none">Currently Listening</span>
	</div>

	{
		data.data === undefined ? <span class="text-sm">Not scrobbling currently!</span> : (
			<>
				<span class="text-sm text-text-1">{data.data.artist} - {data.data.track}</span>
				<a target="_blank" href={data.data.links.release_mbz} class="text-sm text-accent-1 w-fit">
					{data.data.release}
				</a>
				<div class="inline-flex gap-2 text-xs text-text-2">
					<a href={data.data.links.track_apple} target="_blank">Apple Music</a>
					<a href={data.data.links.track_youtube} target="_blank">YouTube</a>
				</div>
			</>
		)
	}
</div>

<script>
	
</script>
